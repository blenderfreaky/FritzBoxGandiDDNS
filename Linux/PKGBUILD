pkgname=fritzbox-gandi-ddns
pkgver=0.0.2
pkgrel=1

pkgdesc="Listen to Fritz!BOX DDNS IP Updates and update Gandi DNS entries accordingly"
url="https://github.com/blenderfreaky/FritzBoxGandiDDNS"
source=("$pkgname-$pkgver.tar.gz::https://github.com/blenderfreaky/FritzBoxGandiDDNS/archive/v$pkgver.tar.gz")
arch=('any')
license=('MIT')

makedepends=('aspnet-runtime')
depends=('aspnet-targeting-pack')

source=(https://github.com/blenderfreaky/FritzBoxGandiDDNS/archive/v$pkgver.tar.gz
        fritzbox-gandi-ddns.service)

sha512sums=('45a1acec0cb3c24c8c4e311b39b2493719bc1bd73fd1bde5a42ae82d5f8f205e075137fae59c8c5ccbb89d2a7235a86b587beb50d8d87d9bdfc112d3df1acd6d'
            '54f41c2a7b135b404380f97af967c413aa9c6db6e6f5a97fa5a4a3df0d056b2426139ebbbac71c095f66dba1ddae1b1980b722d57f912c7d2b936891d5fc3730')

build() {
  cd "$srcdir/$pkgname-$pkgver/FritzBoxGandiDDNS"

  dotnet publish --use-current-runtime -c Release -o fritzbox-gandi-ddns
}

package() {
  cd "$srcdir/$pkgname-$pkgver/FritzBoxGandiDDNS"

  install -Dm755 fritzbox-gandi-ddns/fritzbox-gandi-ddns "$pkgdir/usr/bin/fritzbox-gandi-ddns/fritzbox-gandi-ddns"
  install -Dm644 fritzbox-gandi-ddns/appsettings.json "$pkgdir/usr/bin/fritzbox-gandi-ddns/appsettings.json"
  
  install -Dm644 "$srcdir/fritzbox-gandi-ddns.service" "$pkgdir"/usr/lib/systemd/system/fritzbox-gandi-ddns.service
}