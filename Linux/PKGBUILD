pkgname=fritzbox-gandi-ddns
pkgver=0.0.2
pkgrel=1

pkgdesc="Listen to Fritz!BOX DDNS IP Updates and update Gandi DNS entries accordingly"
url="https://github.com/blenderfreaky/FritzBoxGandiDDNS"
source=("$pkgname-$pkgver.tar.gz::https://github.com/blenderfreaky/FritzBoxGandiDDNS/archive/v$pkgver.tar.gz")
arch=('any')
license=('MIT')

makedepends=('aspnet-runtime')
depends=('aspnet-targeting-pack')

source=(https://github.com/ddclient/ddclient/archive/v$pkgver.tar.gz
        fritzbox-gandi-ddns.service)

sha512sums=('45A1ACEC0CB3C24C8C4E311B39B2493719BC1BD73FD1BDE5A42AE82D5F8F205E075137FAE59C8C5CCBB89D2A7235A86B587BEB50D8D87D9BDFC112D3DF1ACD6D'
            'FB3CFF1E139BCFA84DD9ED5B9369F2031D08C1140D8D1E822AA93363615E7D6D233F9B441D446436B4A9FC575557C5E11FBAC9F2FB32023429832AFEC37ACC05')

build() {
  cd "$srcdir/$pkgname-$pkgver/FritzBoxGandiDDNS"

  dotnet publish --use-current-runtime -c Release -o fritzbox-gandi-ddns
}

package() {
  cd "$srcdir/$pkgname-$pkgver/FritzBoxGandiDDNS"

  install -Dm755 fritzbox-gandi-ddns/fritzbox-gandi-ddns "${pkgdir}/usr/bin/fritzbox-gandi-ddns/fritzbox-gandi-ddns"
  install -Dm644 fritzbox-gandi-ddns/appsettings.json "${pkgdir}/usr/bin/fritzbox-gandi-ddns/appsettings.json"
}