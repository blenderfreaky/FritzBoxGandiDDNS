pkgname=fritzbox-gandi-ddns
pkgver=0.0.1
pkgrel=1

pkgdesc="Listen to Fritz!BOX DDNS IP Updates and update Gandi DNS entries accordingly"
url="https://github.com/blenderfreaky/FritzBoxGandiDDNS"
source=("$pkgname-$pkgver.tar.gz::https://github.com/blenderfreaky/FritzBoxGandiDDNS/archive/v$pkgver.tar.gz")
arch=('any')
license=('MIT')

makedepends=('aspnet-runtime')
depends=('aspnet-targeting-pack')

source=(https://github.com/ddclient/ddclient/archive/v$pkgver.tar.gz
        fritzbox-gandi-ddns.service)

sha512sums=('a8a4d6cb94e4239a7b7b4fc7d9ebef703cbd6c45fc3394b644694a053b5b8aa8d109410b5b8b3676a5f30b18474d24c7feb16c65c30b28bd7d941d8a214b1346'
            'f2d1fe68fb6e358c15ca9bd2e2c4a8b26239607fa71ff2b9aa301a3f54d16c6858e81603e5c0638e89e3da85b7c77ebaca88d38882740a9a8a09e98b38e9b510')

build() {
  cd "$srcdir/$pkgname-$pkgver/FritzBoxGandiDDNS"

  dotnet publish --use-current-runtime -c Release -o fritzbox-gandi-ddns
}

package() {
  cd "$srcdir/$pkgname-$pkgver/FritzBoxGandiDDNS"

  install -Dm755 fritzbox-gandi-ddns/fritzbox-gandi-ddns "${pkgdir}/usr/bin/fritzbox-gandi-ddns/fritzbox-gandi-ddns"
  install -Dm644 fritzbox-gandi-ddns/appsettings.json "${pkgdir}/usr/bin/fritzbox-gandi-ddns/appsettings.json"
}